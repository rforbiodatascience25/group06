---
title: "lab_5_exercises"
format: html
editor: visual
---

# Background

In the early 20s, the world was hit by the coronavirus disease 2019 (COVID-19) pandemic. The pandemic was caused by severe acute respiratory syndrome coronavirus 2 (SARS-CoV-2). In Denmark, the virus first confirmed case was on 27 February 2020.

While initially very little was known about the SARS-CoV-2 virus, we did know the general pathology of vira. Briefly, the virus invades the cells and hijacks the intra-cellular machinery. Using the hijacked machinery, components for new virus particles are produced, eventually being packed into the viral envelope and released from the infected cell. Some of these components, viral proteins, is broken down into smaller fragments called peptides by the proteasome. These peptides are transported into the endoplasmic reticulum by the Transporter Associated with antigen Processing (TAP) protein complex. Here, they are aided by chaperones bound to the Major Histocompatilibty Complex class I (MHC-I) and then across the Golgi apparatus they finally get displayed on the surface of the cells. Note, in humans, MHC is also called Human Leukocyte Antigen (HLA) and represents the most diverse genes. Each of us have a total of 6 HLA-alleles, 3 from the maternal and 3 from the paternal side. These are further divided into 3 classes HLA-A, HLA-B and HLA-C and the combination of these constitute the HLA-haplotype for an individual. Once the peptide is bound to the MHC class I at the cell surface and exposed, the MHC-I peptide complex can be recognised by CD8+ Cytotoxic T-Lymphocytes (CTLs) via the T-cell Receptor (TCR). If a cell displays peptides of viral origin, the CTL gets activated and via a cascade induces apoptosis (programmed cell death) of the infected cell. The process is summarised in the figure below ([McCarthy and Weinberg 2015](https://r4bds.github.io/references.html#ref-McCarthy2015)).

![](images/clipboard-3743273081.png)

# Aim

# **Load Libraries**

```{r}
#| message: false
#| warning: false
library("tidyverse")
library("here")
library("dplyr")
library("ggplot2")
library("readr")
library("tibble")
```

# **Load Data**

```{r}

peptide_data <- read_csv("../../data/peptide-detail-ci.csv")
meta_data <- read_csv("../../data/subject-metadata.csv")

#| echo: true
#| eval: false 
```

# **Data Description**

```{r}
meta_data |> 
  slice_sample(n = 10)
```

```{r}
meta_data
```

```{r}
peptide_data
```

-   **Q1: How many observations of how many variables are in the data?**

    -   Metadata: There are 144 observations of 30 variables
    -   Peptide data: There are 154320 observations and 7 variables

-   **Q2: Are there groupings in the variables, i.e. do certain variables “go together” somehow?**

    -   There are 6 HLA allele variables and 16 other HLA allele variables

```{r}
pl1 <- meta_data |> 
ggplot(aes(x = Cohort,
  fill = Gender)) +
  
  labs(x = "Cohort",
       fill = "Gender") +
  
  theme(plot.title = element_text(size = 13)) + 
  
  geom_histogram()

pl1
```

```{r}
pl1 <- meta_data |>
  
  ggplot(aes(x = Cohort, 
             fill = Gender)) +
  
  labs(x = "Cohort", y = "n", fill = "Gender") +
  
  theme_minimal(base_size = 13) +
  
  theme(
    plot.title = element_text(size = 13),
    legend.position = "bottom",
    axis.text.x = element_text(angle = 15, hjust = 1, vjust = 1)
  ) +
  
  geom_bar(na.rm = TRUE, 
         position = position_dodge(width = 0.9), 
         colour = "black",
         alpha = 0.5)

pl1
```

```{r}

pl1 <- meta_data %>%
  filter(!is.na(Cohort), !is.na(Gender)) %>%     # remove NA rows
  ggplot(aes(x = Cohort, fill = Gender)) +
  geom_bar(position = position_dodge(0.9), colour = "black") +
  labs(x = "Cohort", y = "n", fill = "Gender") +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(size = 13),
    legend.position = "bottom",
    axis.text.x = element_text(angle = 15, hjust = 1, vjust = 1)
  )

pl1
```

# Analysis
