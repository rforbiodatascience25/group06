---
title: "R note collection - 2025"
format: html
---

# Loading packages

## Tidyverse

*Description of tidyverse...*

```{r}
library("tidyverse")
```

Packages that are a part of tidyverse:

-   `ggplot2`
-   `dplyr`
-   `tidyr`
-   `readr`
-   `purrr`
-   `tibble`
-   `stringr`
-   `forcats`
-   `lubridate`

```{r}
library("ggplot2")
library("dplyr")
library("tidyr")
library("readr")
library("purrr")
library("tibble")
library("stringr")
library("forcats")
library("lubridate")
```

# Loading data

## Get data from webpage

```{r}
# Here is an example with the BLOSUM62 matrix data
download.file(
  url = "https://raw.githubusercontent.com/rdpstaff/AlignmentTools/master/src/data/blosum62.txt",
  destfile = "data/_raw/blosum62.txt")
bl62 <- read_table(
  file = "data/_raw/blosum62.txt",
  comment = "#")
bl62
```

# Data wrangling

## Join

### Full join

### Inner join

### Right/left join

### Anti join

Joins everything in the first dataset, that is not overlapping with the second dataset

```{r}
anti_join(X, Y, by = "id")
```

## Table 1 - cohort presentation

The table 1 command creates the classic table known from scientific papers as one of the first tables, which presents the cohort and its characteristics like gender, age etc.

```{r}
library("table1") # <= Yes, this should normally go at the beginning!
meta_data |>
  mutate(Gender = factor(Gender),
         Cohort = factor(Cohort)) |>
  table1(x = formula(~ Gender + Age + Race | Cohort),
         data = _)
```

## Selection of data

### Select all numeric variables

You can use the `select_if` command to select data that fulfills a specific conditions. Here it is all the variables that is numeric

```{r}
bl62_pca <- bl62 |>
  select_if(is.numeric) |>
  prcomp(center = TRUE,
         scale = TRUE)
bl62_pca |>
  str()
```

## Augment

When augmenting the data, the regression information will no longer be attached to a specific datapoint but exists as a separate linear model (OBS check if it is true).

```{r}
bl62_pca_aug <- bl62_pca |>
  augment(bl62)
bl62_pca_aug
```

# Data visualisation

# Functional programming

To make functional programming you are using the purrr package (which is a part of tidyverse). The advantage of functional programming is that you can define a function one time and if you have to make changes it only needs to be changed once.

## Double a value

Creating the function:

```{r}
double_the_value <- function(value){
  return( 2*value )
}

x <- 2
double_the_value(value = x)
```

The result can be "catched" by assigning it to a variable Using the function: The result can be "catched" by asssigning it to a vairalbe

```{r}
y <- double_the_value(value = x)
y
```

# Different general commands

### Separator

When you want to actually separate where the '+' is placed and not on the meaning of the '+', you need to specify it with an escape '\\\\'.

```{r}
sep = "\\+" 
```

## Slice sample

Takes out a specific number of rows from the dataset but randomly. If you only view the top or the bottom there is a risk that the data are sorted and you will only get a wrong understanding of the trend in the data. By using slice_sample you get random rows and you might get a better understanding of the data.

```{r}
meta_data |>
  slice_sample(n = 10)
```

# R packages

-   R packages are an `industry-wide` practice for ensuring `reproducibility` and `consistency` in data analysis.

## What is an R package?

-   A `shareable` collection of `documented` code and/or data

-   A collection of prespecified files with prespecified functions

### **Namespace**

-   The name of space you are working with

-   The namespace contains the names of the variables and functions that is going to be available for that specific package

-   Eg. in tidyverse you can write `mean`, `mutate`, `length` etc. which is defined in the namespace of the `Tidyverse` package

-   It is possible to overwrite the namespace if you define new functions in the script that share the same name as the one in the namespace. If the tidyverse package is loaded first and then the function, the namespace will be overwritten.

The namespace file can exist on each GitHub users computer and it will give conflicts when trying to merge.
`> devtools::document()
ℹ Updating cdogma documentation
ℹ Loading cdogma
Warning message:
Skipping NAMESPACE
✖ It already exists and was not generated by roxygen2.`

To solve this problem the `NAMESPACE` file needs to be deleted and the `devtools::document()` command needs to be rerun

### Vignette

-   A little tutorial that explains the basic functionality of a package

-   It is not a replacement for documentation, but rather a starting point for new users

## Loading R packages

-   Makes functions/objects available.

-   Requires prefixing function/object with the package name: `::`.

-   This secures that if the namespace if overwritten it is specified from which package the function should be taken

```{r}
dplyr::mutate()
```

## Attaching

## Building R packages

### Testing the package

-   Using the `testthat` command, where we then create a collection of `expect_*` functions that check for specific conditions relevant for the specific function.

# GitHub

## Remote

-   A way to connect to GitHub from a remote

```{r}

```

# Shiny app

-   A way to share your code with someone who doesn't know how to code

-   A shiny app is a way to make an interactive app that makes people able to use R packages by clicking/interacting with the app

## How to make a shiny app

```{r}
# Load the Shiny library
library("shiny")

# Define the User Interface (Frontend)
ui <- fluidPage(
  titlePanel("Hello Shiny!"),
  sidebarLayout(
    sidebarPanel(
      sliderInput(inputId = "bins",
                  label = "Number of bins:",
                  min = 1,
                  max = 50,
                  value = 30)
    ),
    mainPanel(
      plotOutput(outputId = "distPlot")
    )
  )
)

# Define the Server (Backend)
server <- function(input, output) {
  output$distPlot <- renderPlot({
    x <- faithful$waiting
    bins <- seq(min(x), max(x), length.out = input$bins + 1)
    hist(x, breaks = bins, col = "#75AADB", border = "white",
         xlab = "Waiting time to next eruption (in mins)",
         main = "Histogram of waiting times")
  })
}

# Launch the shiny app
shinyApp(ui = ui, server = server)
```

-   The IDs need to be unique

### Frontend

-   Where the user interacts with the app

-   Chooses arguments to function parameters

-   Choices are “requests”

### Backend

-   The server

-   This is where the computations are made in response to the user’s choices

-   Chosen arguments are passed to function parameters, producing an output

-   The output is the “response”
